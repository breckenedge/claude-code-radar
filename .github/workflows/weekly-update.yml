name: Weekly Radar Update

on:
  schedule:
    # Every Monday at 15:00 UTC (9am CST)
    - cron: '0 15 * * 1'
  workflow_dispatch: # Allow manual trigger for testing

jobs:
  update-radar:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
      id-token: write
    steps:
      - uses: actions/checkout@v4

      - uses: anthropics/claude-code-action@v1
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          claude_args: "--allowedTools 'Bash(git:*) Bash(gh:*) Edit Read Write Grep Glob WebSearch WebFetch' --max-budget-usd 5"
          prompt: |
            You are updating the Claude Code Technology Radar in README.md.

            Your job:
            1. Read the current README.md carefully
            2. Research what's changed in the Claude Code ecosystem this past week (web search for news, releases, blog posts, GitHub activity)
            3. For each existing blip, check if the ring placement still makes sense
            4. Look for new blips that should be added (remember the inclusion criteria in "What's On vs Off the Radar")
            5. Look for blips that should move rings or be removed
            6. Update README.md with any changes
            7. Keep changes minimal and justified — don't churn for the sake of churn
            8. If nothing meaningful changed this week, make no edits

            Rules:
            - Stay focused on the Claude Code ecosystem, not general AI coding
            - No hype stats, no marketing language
            - Link new blips to their official URLs
            - Keep notes concise

            Open a PR with your changes. Title it "Weekly radar update — [date]".
            If nothing changed, open a PR anyway with a comment explaining why.
